---
title: "Simple Linear Regression"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
### Regression - Theory
Regression models (both linear and non-linear) are used for predicting a real value, like salary for example. If your independent variable is time, then you are forecasting future values, otherwise your model is predicting present but unknown values. Regression technique vary from Linear Regression to SVR and Random Forests Regression.

Machine Learning Regression models:

Simple Linear Regression
Multiple Linear Regression
Polynomial Regression
Support Vector for Regression (SVR)
Decision Tree Classification
Random Forest Classification

### Linear Regression - Theory

In simple linear regression, we predict scores on one variable Y from the scores on a second variable X. 

Y' = bX + A

Y Dependent Variable (DV)
X Independent Variable (IV). Causes Y to change
b Coefficient. Describes how a unit change in X affects Y.
A Constant

Pros: Works on any size of dataset, gives informations about relevance of features
Cons: The Linear Regression Assumptions


### Business Problem (Udemy)

Is there a correlation between Years of Experience and Salary?

What is the best fitting line for this relationship / how should the salary be set for future employees?

Variables:
- YearsExperience
- Salary

-- Importing dataset -- 
```{r Importing the dataset}
dataset = read.csv('Salary_Data.csv')
```

-- Inspecting dataset -- 
```{r Inspecting dataset}
head(dataset)
```
  
-- Splitting the dataset into a Training set and a Test set  -- 
```{r splitting dataset}
library(caTools)
set.seed(123)
split = sample.split(dataset$Salary, SplitRatio = 2/3)
training_set = subset(dataset, split == TRUE) # 20 obs.
test_set = subset(dataset, split == FALSE) # 10 obs.
```

-- Fitting Simple Linear Regression to the Training Set -- 
```{r fitting model}
regressor = lm(formula = Salary ~ YearsExperience, data = training_set)
summary(regressor)
```
Looking at coefficiants: very small p-value.

Years of Experience are highliy statistical significant -> has high impact on DV.

-- Predicting the test results --
```{r predicting results}
y_pred = predict(regressor, newdata = test_set)
round(y_pred)
test_set[,2]
```

-- Visualising the results -- 
```{r Visualisation}

# Training set results
# real salaries of employees in red dots, predicted salary in blue
library(ggplot2)

ggplot() +
  geom_point(aes(x=training_set$YearsExperience, y = training_set$Salary),
             colour = 'red') +
  geom_line(aes(x=training_set$YearsExperience, y = predict(regressor, newdata = training_set)),
            colour = 'blue') +
  ggtitle('Salary vs Experience (Training set)') +
  xlab('Years of experience') + 
  ylab('Salary')
```


```{r Visualisation2}
# Test set results
# real salaries (from test set) of employees in red dots, predicted salary in blue (trained on training set)
ggplot() +
  geom_point(aes(x=test_set$YearsExperience, y = test_set$Salary),
             colour = 'red') +
  geom_line(aes(x=training_set$YearsExperience, y = predict(regressor, newdata = training_set)),
            colour = 'blue') +
  ggtitle('Salary vs Experience (Test set)') +
  xlab('Years of experience') + 
  ylab('Salary')

```


